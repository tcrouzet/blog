<<<<<<< Updated upstream
<<<<<<< Updated upstream
<!DOCTYPE html><html lang=fr><head><meta charset=utf-8><meta name=viewport content="width=device-width, initial-scale=1.0"><title>Optimiser les cartes des GPS Garmin - Thierry Crouzet</title><link rel="shortcut icon" href=/favicon.ico><link rel=alternate type=application/rss+xml title="Thierry Crouzet" href=/feeds/feed.xml><link rel=preload href="/style.css?ver=1761979510.7583401" as=style><link rel=stylesheet href="/style.css?ver=1761979510.7583401"><meta name=robots content="index, follow"><meta name=google-site-verification content=EmtKKbIk2-Tz3Nyp7hJRPjcMbgf68Vwq6yJYs1hvsqA><meta name=msvalidate.01 content=805E5BFBA891A41968028F5C97A228D3><meta name=description content="J’utilise un GPS pour suivre des traces, que ce soit en bikepacking, ou lors de randonnées organisées par des tiers, ou même lorsque je trace mes propres parco…"><meta name=author content="Thierry Crouzet"><link href=https://tcrouzet.com/2020/10/23/optimiser-les-cartes-des-gps-garmin/ rel=canonical><meta name=fediverse:creator content=@tcrouzet@mamot.fr><meta property=og:title content="Optimiser les cartes des GPS Garmin"><meta property=og:description content="J’utilise un GPS pour suivre des traces, que ce soit en bikepacking, ou lors de randonnées organisées par des tiers, ou même lorsque je trace mes propres parco…"><meta content=https://tcrouzet.com/2020/10/23/optimiser-les-cartes-des-gps-garmin/ property=og:url><meta property=og:locale content=fr_FR><meta property=og:type content=article><meta property=og:site_name content="Thierry Crouzet"><meta property=article:published_time content=2020-10-23T17:32:00+02:00><meta property=article:modified_time content=2024-04-30T10:08:48+02:00><meta property=og:image content=https://tcrouzet.com//images_tc/2020/10/mapcode.jpeg><meta property=og:image:width content=1024><meta property=og:image:height content=640><meta property=og:image:type content=image/jpeg><meta property=og:image:alt content="Faut entrer dans le code"><meta name=twitter:card content=summary_large_image><meta name=twitter:image content=/images_tc/2020/10/mapcode.jpeg></head><body><header><a href=/menu/ aria-label=Menu></a><a aria-label=Accueil href=/ title=Accueil>Thierry <b>CROUZET</b></a><a href=/search/ aria-label=Recherche></a></header><main><article itemscope itemtype=https://schema.org/BlogPosting><header><figure><img width=1024 height=640 src=/images_tc/2020/10/mapcode.webp class="poster-img poster-img-full" alt="Faut entrer dans le code" fetchpriority=high decoding=async srcset="/images_tc/2020/10/mapcode-250.webp 250w,/images_tc/2020/10/mapcode.webp 1024w" sizes="(max-width: 1024px) 100vw, 1024px"><figcaption>Faut entrer dans le code</figcaption></figure><h1 itemprop=headline>Optimiser les cartes des GPS Garmin</h1></header><section itemprop=articleBody><p>J’utilise un GPS pour suivre des traces, que ce soit en bikepacking, ou lors de randonnées organisées par des tiers, ou même lorsque je trace mes propres parcours. Mon problème : la plupart des cartes disponibles pour Garmin sont surchargées d’informations et de couleurs, et la trace se confond souvent avec elles, surtout en plein soleil, et la suivre devient alors difficile. J’ai donc décidé de créer une carte optimisée.</p><h3>Rendu avec carte Garmin</h3><figure><img alt="Rendu Garmin" class=small decoding=async height=699 loading=lazy sizes="(max-width: 1024px) 100vw, 1024px" src=/images_tc/2020/10/newmap-garmin.webp srcset="/images_tc/2020/10/newmap-garmin.webp 1024w, /images_tc/2020/10/newmap-garmin-250.webp 250w" width=1024><figcaption class="legend legend-center">Rendu Garmin</figcaption></figure><p>Selon moi, la carte fournie par Garmin est trop colorée pour le suivi de trace (ce serait possible si Garmin offrait la possibilité de calibrer la taille de la trace, ce qui n’est pas le cas sur mon nouveau 530 et ne l’était pas davantage sur mon 820). On ne peut que changer la couleur de la trace (et cela fastidieusement au coup par coup). Notez que la capture d’écran effectuée sur BaseCamp est très flatteuse.</p><h3>Rendu avec carte OSM new style</h3><figure><img alt="Rendu OSM new style" class=small decoding=async height=699 loading=lazy sizes="(max-width: 1024px) 100vw, 1024px" src=/images_tc/2020/10/newmap-newstyle.webp srcset="/images_tc/2020/10/newmap-newstyle.webp 1024w, /images_tc/2020/10/newmap-newstyle-250.webp 250w" width=1024><figcaption class="legend legend-center">Rendu OSM new style</figcaption></figure><p>Jusqu’alors ma favorite, <a href=https://garmin3.bbbike.org/ rel="noopener noreferrer">la version OSM téléchargeable gratuitement</a> reste quelque peu baroque, avec notamment des routes souvent colorées.</p><h3>Rendu avec ma carte</h3><figure><img alt="Rendu OSM minimaliste" class=small decoding=async height=699 loading=lazy sizes="(max-width: 1024px) 100vw, 1024px" src=/images_tc/2020/10/newmap-minimalist.webp srcset="/images_tc/2020/10/newmap-minimalist.webp 1024w, /images_tc/2020/10/newmap-minimalist-250.webp 250w" width=1024><figcaption class="legend legend-center">Rendu OSM minimaliste</figcaption></figure><p>J’ai donc créé une trace OSM minimaliste, sans POI, sans texte, sans couleur ou presque. Au passage, j’ai fait passer le fichier France de 1,6 Go à 320 Mo, tout en incluant les données altimétriques.</p><p><a href=https://mega.nz/file/19FliI6a#sCYLfnpTCWx99PMWHVEUaq-IARhWUgK21BnswbvXXjQ rel="noopener noreferrer">Vous pouvez télécharger la carte</a> (je ne vous garantis pas de la mettre à jour souvent). Pour l’installer, copiez le fichier dans le dossier Garmin de votre GPS. Si une carte du même nom existe, renommez-là. Il vous reste à dire au GPS d’utiliser de préférence la nouvelle carte (ce qui revient à désactiver les autres). Attention, cette carte n’est pas routable et ne sert que lors du suivi de traces (sur les nouveaux Garmin on peut créer des profils avec des cartes différentes).</p><h3>Rendu avec carte IGN</h3><figure><img alt="Rendu IGN" class=small decoding=async height=699 loading=lazy sizes="(max-width: 1024px) 100vw, 1024px" src=/images_tc/2020/10/newmap-ign.webp srcset="/images_tc/2020/10/newmap-ign.webp 1024w, /images_tc/2020/10/newmap-ign-250.webp 250w" width=1024><figcaption class="legend legend-center">Rendu IGN</figcaption></figure><p>Sur le Garmin 820, je n’utilisais pas l’IGN parce que l’affichage se traînait tout en manquant de précision. Avec le 530, c’est nettement plus fluide et le contraste de la trace est bien meilleur que sur les cartes Garmin ou OSM. C’est une alternative onéreuse à mon bricolage.</p><h3>Geek only</h3><p>Je résume comment je m’y suis pris pour fabriquer cette carte, tout en faisant hurler le Mac (la même manip marche sous Windows).</p><ol><li><a href=https://www.java.com/fr/download/ rel="noopener noreferrer">Installer Java</a>.</li><li><a href=https://www.oracle.com/java/technologies/javase-jdk15-downloads.html rel="noopener noreferrer">Installer Java SE Development Kit</a>.</li><li>Créer un dossier de travail (dans mon cas <em>~/Documents/GarminMaps/tools/</em>).</li><li><a href=https://download.geofabrik.de/europe/france.html rel="noopener noreferrer">Télécharger dans le dossier <em>tools</em> la dernière source OSM pour France</a> (<a href=http://download.openstreetmap.fr/extracts/europe/ rel="noopener noreferrer">possibilité de télécharger les régions, les départements, d’autres pays…</a>). Ce fichier a pour nom : <em>france-latest.osm.pbf</em>.</li><li><a href=http://www.mkgmap.org.uk/download/splitter.html rel="noopener noreferrer">Télécharger Splitter</a>, un logiciel qui découpera la carte OSM pour que le Mac puisse la digérer.</li><li><a href=http://www.mkgmap.org.uk/download/mkgmap.html rel="noopener noreferrer">Télécharger Mkgmap</a>, un logiciel qui recollera les bouts et créera une carte au format Garmin.</li><li><a href=https://mega.nz/file/RplyUa7L#DZtAnF6QgfrxCWEquqLv0rAyeDAopUPBH-De1C_xscY rel="noopener noreferrer">Télécharger les styles de la nouvelle carte</a> (voilà qui m’a pris la tête et je suis loin d’être devenu un expert du sujet). Reste pas mal de boulot à faire pour créer la carte optimale.</li><li>Décompresser le dossier <em>mystyle</em>. Il contient les fichiers texte qui contrôlent le rendu de la carte.</li><li>Ouvrir le terminal et aller dans <em>tools</em> avec un <em>cd /Users/thierrycrouzet/Documents/GarminMaps/tools/</em>.</li><li>Exécuter Spliter avec <em>java -Xmx3000m -jar splitter/splitter.jar --max-nodes=1100000 france-latest.osm.pbf --output-dir=outputsplit</em>. Ça prend un bon moment.</li><li>Exécuter Mkgmap avec <em>java -Xmx3000m -jar mkgmap/mkgmap.jar --style-file=mystyle --output-dir=output --no-net --product-id=1 --overview-mapname="OSM minimalist" --family-name="OSM minimalist" --series-name="OSM minimalist" --description="OSM minimalist" --area-name="OSM minimalist" --gmapsupp -c outputsplit/template.args</em>. C’est reparti pour au moins aussi longtemps.</li><li>La carte <em>gmapsupp.img</em> se retrouve dans le dossier <em>output</em>.</li><li>J’ai dû picorer des infos <a href=https://wiki.openstreetmap.org/wiki/FR:Mkgmap rel="noopener noreferrer">ici</a> et <a href=https://github.com/ligfietser/mkgmap-style-sheets rel="noopener noreferrer">là</a> ou encore <a href=https://www.cferrero.net/maps/guide_to_mkgmap_style_files.html rel="noopener noreferrer">là</a> avant de m’en sortir, et aussi en tâtonnant beaucoup.</li></ol></section><footer><nav><a href=/2020/10/20/mini-aventure-gravel-de-la-nuit-a-la-nuit/ class=prev rel=prev>&lt; </a><a href=/tag/borntobike itemprop=articleSection>Vélo 71</a> ● <a href=/2020/ ><time datetime=2020-10-23T17:32:00 title="Publié à 17:32">23 octobre 2020</time></a><a href=/2020/11/02/une-journee-volee-pour-vivre/ class=next rel=next> &gt;</a></nav><section><a class=icon_download href=https://raw.githubusercontent.com/tcrouzet/md/refs/heads/main/2020/10/optimiser-les-cartes-des-gps-garmin.md download title=Télécharger aria-label="Télécharger en Markdown"></a><a class=icon_friends href=/page/lectures/ title="Sites amis" aria-label="Afficher les sites amis"></a></section><div><a href=/page/abonnement-par-mail/ ><svg width=24 height=18 viewbox="0 0 24 18" fill=none xmlns=http://www.w3.org/2000/svg><path d="M21.75 1.5H2.25c-.828 0-1.5.672-1.5 1.5v12c0 .828.672 1.5 1.5 1.5h19.5c.828 0 1.5-.672 1.5-1.5V3c0-.828-.672-1.5-1.5-1.5zM15.687 6.975L19.5 10.5M8.313 6.975L4.5 10.5" stroke=#fff stroke-width=1.5 stroke-linecap=round stroke-linejoin=round></path><path d="M22.88 2.014l-9.513 6.56C12.965 8.851 12.488 9 12 9s-.965-.149-1.367-.426L1.12 2.014" stroke=#fff stroke-width=1.5 stroke-linecap=round stroke-linejoin=round></path></svg> Newsletters </a><a href=/page/me-soutenir/ class=link-background> Me soutenir </a></div></footer></article></main></body></html>
=======
<!DOCTYPE html><html lang=fr><head><meta charset=utf-8><meta name=viewport content="width=device-width, initial-scale=1.0"><title>Optimiser les cartes des GPS Garmin - Thierry Crouzet</title><link rel="shortcut icon" href=/favicon.ico><link rel=alternate type=application/rss+xml title="Thierry Crouzet" href=/feeds/feed.xml><!-- Google Fonts --><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Bitter:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel=stylesheet><link rel=preload href="/style.css?ver=52" as=style><link rel=stylesheet href="/style.css?ver=52"><meta name=robots content="index, follow"><meta name=google-site-verification content=EmtKKbIk2-Tz3Nyp7hJRPjcMbgf68Vwq6yJYs1hvsqA><meta name=msvalidate.01 content=805E5BFBA891A41968028F5C97A228D3><meta name=description content="J’utilise un GPS pour suivre des traces, que ce soit en bikepacking, ou lors de randonnées organisées par des tiers, ou même lorsque je trace mes propres parco…"><meta name=author content="Thierry Crouzet"><link href=https://tcrouzet.com/2020/10/23/optimiser-les-cartes-des-gps-garmin/ rel=canonical><meta name=fediverse:creator content=@tcrouzet@mamot.fr><meta property=og:title content="Optimiser les cartes des GPS Garmin"><meta property=og:description content="J’utilise un GPS pour suivre des traces, que ce soit en bikepacking, ou lors de randonnées organisées par des tiers, ou même lorsque je trace mes propres parco…"><meta content=https://tcrouzet.com/2020/10/23/optimiser-les-cartes-des-gps-garmin/ property=og:url><meta property=og:locale content=fr_FR><meta property=og:type content=article><meta property=og:site_name content="Thierry Crouzet"><meta property=article:published_time content=2020-10-23T17:32:00+02:00><meta property=article:modified_time content=2024-04-30T10:08:48+02:00><meta property=og:image content=https://tcrouzet.com//images_tc/2020/10/mapcode.jpeg><meta property=og:image:width content=1600><meta property=og:image:height content=1000><meta property=og:image:type content=image/jpeg><meta property=og:image:alt content="Faut entrer dans le code"><meta name=twitter:card content=summary_large_image><meta name=twitter:image content=/images_tc/2020/10/mapcode.jpeg></head><body><header><a href=/menu/ aria-label=Menu></a><a aria-label=Accueil href=/ title=Accueil>Thierry <b>CROUZET</b></a><a href=/search/ aria-label=Recherche></a></header><main><article itemscope itemtype=https://schema.org/BlogPosting><header><figure><img width=1600 height=1000 src=/images_tc/2020/10/mapcode.webp class="poster-img poster-img-full" alt="Faut entrer dans le code" fetchpriority=high decoding=async srcset="/images_tc/2020/10/mapcode.webp 250w,/images_tc/2020/10/mapcode.webp 1024w,/images_tc/2020/10/mapcode.webp 1600w" sizes="(max-width: 1600px) 100vw, 1600px"><figcaption>Faut entrer dans le code</figcaption></figure><h1 itemprop=headline>Optimiser les cartes des GPS Garmin</h1><nav><a href=/2020/10/20/mini-aventure-gravel-de-la-nuit-a-la-nuit/ class=prev rel=prev>&lt; </a><a href=/tag/borntobike itemprop=articleSection>Vélo 71</a> ● <a href=/2020/ ><time datetime=2020-10-23T17:32:00 title="Publié à 17:32">23 octobre 2020</time></a><a href=/2020/11/02/une-journee-volee-pour-vivre/ class=next rel=next> &gt;</a></nav></header><section itemprop=articleBody><p>J’utilise un GPS pour suivre des traces, que ce soit en bikepacking, ou lors de randonnées organisées par des tiers, ou même lorsque je trace mes propres parcours. Mon problème : la plupart des cartes disponibles pour Garmin sont surchargées d’informations et de couleurs, et la trace se confond souvent avec elles, surtout en plein soleil, et la suivre devient alors difficile. J’ai donc décidé de créer une carte optimisée.</p><h3>Rendu avec carte Garmin</h3><figure><img alt="Rendu Garmin" decoding=async height=1093 loading=lazy sizes="(max-width: 1600px) 100vw, 1600px" src=/images_tc/2020/10/newmap-garmin.webp srcset="/images_tc/2020/10/newmap-garmin.webp 1600w, /images_tc/2020/10/newmap-garmin.webp 1024w, /images_tc/2020/10/newmap-garmin.webp 250w" width=1600><figcaption>Rendu Garmin</figcaption></figure><p>Selon moi, la carte fournie par Garmin est trop colorée pour le suivi de trace (ce serait possible si Garmin offrait la possibilité de calibrer la taille de la trace, ce qui n’est pas le cas sur mon nouveau 530 et ne l’était pas davantage sur mon 820). On ne peut que changer la couleur de la trace (et cela fastidieusement au coup par coup). Notez que la capture d’écran effectuée sur BaseCamp est très flatteuse.</p><h3>Rendu avec carte OSM new style</h3><figure><img alt="Rendu OSM new style" decoding=async height=1093 loading=lazy sizes="(max-width: 1600px) 100vw, 1600px" src=/images_tc/2020/10/newmap-newstyle.webp srcset="/images_tc/2020/10/newmap-newstyle.webp 1600w, /images_tc/2020/10/newmap-newstyle.webp 1024w, /images_tc/2020/10/newmap-newstyle.webp 250w" width=1600><figcaption>Rendu OSM new style</figcaption></figure><p>Jusqu’alors ma favorite, <a href=https://garmin3.bbbike.org/ rel="noopener noreferrer">la version OSM téléchargeable gratuitement</a> reste quelque peu baroque, avec notamment des routes souvent colorées.</p><h3>Rendu avec ma carte</h3><figure><img alt="Rendu OSM minimaliste" decoding=async height=1093 loading=lazy sizes="(max-width: 1600px) 100vw, 1600px" src=/images_tc/2020/10/newmap-minimalist.webp srcset="/images_tc/2020/10/newmap-minimalist.webp 1600w, /images_tc/2020/10/newmap-minimalist.webp 1024w, /images_tc/2020/10/newmap-minimalist.webp 250w" width=1600><figcaption>Rendu OSM minimaliste</figcaption></figure><p>J’ai donc créé une trace OSM minimaliste, sans POI, sans texte, sans couleur ou presque. Au passage, j’ai fait passer le fichier France de 1,6 Go à 320 Mo, tout en incluant les données altimétriques.</p><p><a href=https://mega.nz/file/19FliI6a#sCYLfnpTCWx99PMWHVEUaq-IARhWUgK21BnswbvXXjQ rel="noopener noreferrer">Vous pouvez télécharger la carte</a> (je ne vous garantis pas de la mettre à jour souvent). Pour l’installer, copiez le fichier dans le dossier Garmin de votre GPS. Si une carte du même nom existe, renommez-là. Il vous reste à dire au GPS d’utiliser de préférence la nouvelle carte (ce qui revient à désactiver les autres). Attention, cette carte n’est pas routable et ne sert que lors du suivi de traces (sur les nouveaux Garmin on peut créer des profils avec des cartes différentes).</p><h3>Rendu avec carte IGN</h3><figure><img alt="Rendu IGN" decoding=async height=1093 loading=lazy sizes="(max-width: 1600px) 100vw, 1600px" src=/images_tc/2020/10/newmap-ign.webp srcset="/images_tc/2020/10/newmap-ign.webp 1600w, /images_tc/2020/10/newmap-ign.webp 1024w, /images_tc/2020/10/newmap-ign.webp 250w" width=1600><figcaption>Rendu IGN</figcaption></figure><p>Sur le Garmin 820, je n’utilisais pas l’IGN parce que l’affichage se traînait tout en manquant de précision. Avec le 530, c’est nettement plus fluide et le contraste de la trace est bien meilleur que sur les cartes Garmin ou OSM. C’est une alternative onéreuse à mon bricolage.</p><h3>Geek only</h3><p>Je résume comment je m’y suis pris pour fabriquer cette carte, tout en faisant hurler le Mac (la même manip marche sous Windows).</p><ol><li><a href=https://www.java.com/fr/download/ rel="noopener noreferrer">Installer Java</a>.</li><li><a href=https://www.oracle.com/java/technologies/javase-jdk15-downloads.html rel="noopener noreferrer">Installer Java SE Development Kit</a>.</li><li>Créer un dossier de travail (dans mon cas <em>~/Documents/GarminMaps/tools/</em>).</li><li><a href=https://download.geofabrik.de/europe/france.html rel="noopener noreferrer">Télécharger dans le dossier <em>tools</em> la dernière source OSM pour France</a> (<a href=http://download.openstreetmap.fr/extracts/europe/ rel="noopener noreferrer">possibilité de télécharger les régions, les départements, d’autres pays…</a>). Ce fichier a pour nom : <em>france-latest.osm.pbf</em>.</li><li><a href=http://www.mkgmap.org.uk/download/splitter.html rel="noopener noreferrer">Télécharger Splitter</a>, un logiciel qui découpera la carte OSM pour que le Mac puisse la digérer.</li><li><a href=http://www.mkgmap.org.uk/download/mkgmap.html rel="noopener noreferrer">Télécharger Mkgmap</a>, un logiciel qui recollera les bouts et créera une carte au format Garmin.</li><li><a href=https://mega.nz/file/RplyUa7L#DZtAnF6QgfrxCWEquqLv0rAyeDAopUPBH-De1C_xscY rel="noopener noreferrer">Télécharger les styles de la nouvelle carte</a> (voilà qui m’a pris la tête et je suis loin d’être devenu un expert du sujet). Reste pas mal de boulot à faire pour créer la carte optimale.</li><li>Décompresser le dossier <em>mystyle</em>. Il contient les fichiers texte qui contrôlent le rendu de la carte.</li><li>Ouvrir le terminal et aller dans <em>tools</em> avec un <em>cd /Users/thierrycrouzet/Documents/GarminMaps/tools/</em>.</li><li>Exécuter Spliter avec <em>java -Xmx3000m -jar splitter/splitter.jar --max-nodes=1100000 france-latest.osm.pbf --output-dir=outputsplit</em>. Ça prend un bon moment.</li><li>Exécuter Mkgmap avec <em>java -Xmx3000m -jar mkgmap/mkgmap.jar --style-file=mystyle --output-dir=output --no-net --product-id=1 --overview-mapname="OSM minimalist" --family-name="OSM minimalist" --series-name="OSM minimalist" --description="OSM minimalist" --area-name="OSM minimalist" --gmapsupp -c outputsplit/template.args</em>. C’est reparti pour au moins aussi longtemps.</li><li>La carte <em>gmapsupp.img</em> se retrouve dans le dossier <em>output</em>.</li><li>J’ai dû picorer des infos <a href=https://wiki.openstreetmap.org/wiki/FR:Mkgmap rel="noopener noreferrer">ici</a> et <a href=https://github.com/ligfietser/mkgmap-style-sheets rel="noopener noreferrer">là</a> ou encore <a href=https://www.cferrero.net/maps/guide_to_mkgmap_style_files.html rel="noopener noreferrer">là</a> avant de m’en sortir, et aussi en tâtonnant beaucoup.</li></ol></section><footer><section><button class=icon_com onclick="showComments('com2232')" title=Commenter aria-label="Afficher les commentaires"></button><button class=icon_share onclick=copyText() title=Partager aria-label="Partager l'article"></button><a class=icon_download href=https://raw.githubusercontent.com/tcrouzet/md/refs/heads/main/2020/10/optimiser-les-cartes-des-gps-garmin.md download title=Télécharger aria-label="Télécharger en Markdown"></a><a class=icon_friends href=/page/lectures/ title="Sites amis" aria-label="Afficher les sites amis"></a></section><div class=comments id=com2232 data-post-url=2020/10/23/optimiser-les-cartes-des-gps-garmin/ data-post-title="Optimiser les cartes des GPS Garmin" data-post-date=2020-10-23T17:32:00+02:00 hidden></div><div><a href=/page/abonnement-par-mail/ ><svg width=24 height=18 viewbox="0 0 24 18" fill=none xmlns=http://www.w3.org/2000/svg><path d="M21.75 1.5H2.25c-.828 0-1.5.672-1.5 1.5v12c0 .828.672 1.5 1.5 1.5h19.5c.828 0 1.5-.672 1.5-1.5V3c0-.828-.672-1.5-1.5-1.5zM15.687 6.975L19.5 10.5M8.313 6.975L4.5 10.5" stroke=#fff stroke-width=1.5 stroke-linecap=round stroke-linejoin=round></path><path d="M22.88 2.014l-9.513 6.56C12.965 8.851 12.488 9 12 9s-.965-.149-1.367-.426L1.12 2.014" stroke=#fff stroke-width=1.5 stroke-linecap=round stroke-linejoin=round></path></svg> Newsletters </a><a href=/page/me-soutenir/ class=link-background> Me soutenir </a></div></footer></article><div id=loadMore next-url=/2020/10/20/mini-aventure-gravel-de-la-nuit-a-la-nuit/ hidden></div></main><script src="/toggle.js?ver=52" defer></script></body></html>
>>>>>>> Stashed changes
=======
<!DOCTYPE html><html lang=fr><head><meta charset=utf-8><meta name=viewport content="width=device-width, initial-scale=1.0"><title>Optimiser les cartes des GPS Garmin - Thierry Crouzet</title><link rel="shortcut icon" href=/favicon.ico><link rel=alternate type=application/rss+xml title="Thierry Crouzet" href=/feeds/feed.xml><!-- Google Fonts --><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Bitter:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel=stylesheet><link rel=preload href="/style.css?ver=52" as=style><link rel=stylesheet href="/style.css?ver=52"><meta name=robots content="index, follow"><meta name=google-site-verification content=EmtKKbIk2-Tz3Nyp7hJRPjcMbgf68Vwq6yJYs1hvsqA><meta name=msvalidate.01 content=805E5BFBA891A41968028F5C97A228D3><meta name=description content="J’utilise un GPS pour suivre des traces, que ce soit en bikepacking, ou lors de randonnées organisées par des tiers, ou même lorsque je trace mes propres parco…"><meta name=author content="Thierry Crouzet"><link href=https://tcrouzet.com/2020/10/23/optimiser-les-cartes-des-gps-garmin/ rel=canonical><meta name=fediverse:creator content=@tcrouzet@mamot.fr><meta property=og:title content="Optimiser les cartes des GPS Garmin"><meta property=og:description content="J’utilise un GPS pour suivre des traces, que ce soit en bikepacking, ou lors de randonnées organisées par des tiers, ou même lorsque je trace mes propres parco…"><meta content=https://tcrouzet.com/2020/10/23/optimiser-les-cartes-des-gps-garmin/ property=og:url><meta property=og:locale content=fr_FR><meta property=og:type content=article><meta property=og:site_name content="Thierry Crouzet"><meta property=article:published_time content=2020-10-23T17:32:00+02:00><meta property=article:modified_time content=2024-04-30T10:08:48+02:00><meta property=og:image content=https://tcrouzet.com//images_tc/2020/10/mapcode.jpeg><meta property=og:image:width content=1600><meta property=og:image:height content=1000><meta property=og:image:type content=image/jpeg><meta property=og:image:alt content="Faut entrer dans le code"><meta name=twitter:card content=summary_large_image><meta name=twitter:image content=/images_tc/2020/10/mapcode.jpeg></head><body><header><a href=/menu/ aria-label=Menu></a><a aria-label=Accueil href=/ title=Accueil>Thierry <b>CROUZET</b></a><a href=/search/ aria-label=Recherche></a></header><main><article itemscope itemtype=https://schema.org/BlogPosting><header><figure><img width=1600 height=1000 src=/images_tc/2020/10/mapcode.webp class="poster-img poster-img-full" alt="Faut entrer dans le code" fetchpriority=high decoding=async srcset="/images_tc/2020/10/mapcode.webp 250w,/images_tc/2020/10/mapcode.webp 1024w,/images_tc/2020/10/mapcode.webp 1600w" sizes="(max-width: 1600px) 100vw, 1600px"><figcaption>Faut entrer dans le code</figcaption></figure><h1 itemprop=headline>Optimiser les cartes des GPS Garmin</h1><nav><a href=/2020/10/20/mini-aventure-gravel-de-la-nuit-a-la-nuit/ class=prev rel=prev>&lt; </a><a href=/tag/borntobike itemprop=articleSection>Vélo 71</a> ● <a href=/2020/ ><time datetime=2020-10-23T17:32:00 title="Publié à 17:32">23 octobre 2020</time></a><a href=/2020/11/02/une-journee-volee-pour-vivre/ class=next rel=next> &gt;</a></nav></header><section itemprop=articleBody><p>J’utilise un GPS pour suivre des traces, que ce soit en bikepacking, ou lors de randonnées organisées par des tiers, ou même lorsque je trace mes propres parcours. Mon problème : la plupart des cartes disponibles pour Garmin sont surchargées d’informations et de couleurs, et la trace se confond souvent avec elles, surtout en plein soleil, et la suivre devient alors difficile. J’ai donc décidé de créer une carte optimisée.</p><h3>Rendu avec carte Garmin</h3><figure><img alt="Rendu Garmin" decoding=async height=1093 loading=lazy sizes="(max-width: 1600px) 100vw, 1600px" src=/images_tc/2020/10/newmap-garmin.webp srcset="/images_tc/2020/10/newmap-garmin.webp 1600w, /images_tc/2020/10/newmap-garmin.webp 1024w, /images_tc/2020/10/newmap-garmin.webp 250w" width=1600><figcaption>Rendu Garmin</figcaption></figure><p>Selon moi, la carte fournie par Garmin est trop colorée pour le suivi de trace (ce serait possible si Garmin offrait la possibilité de calibrer la taille de la trace, ce qui n’est pas le cas sur mon nouveau 530 et ne l’était pas davantage sur mon 820). On ne peut que changer la couleur de la trace (et cela fastidieusement au coup par coup). Notez que la capture d’écran effectuée sur BaseCamp est très flatteuse.</p><h3>Rendu avec carte OSM new style</h3><figure><img alt="Rendu OSM new style" decoding=async height=1093 loading=lazy sizes="(max-width: 1600px) 100vw, 1600px" src=/images_tc/2020/10/newmap-newstyle.webp srcset="/images_tc/2020/10/newmap-newstyle.webp 1600w, /images_tc/2020/10/newmap-newstyle.webp 1024w, /images_tc/2020/10/newmap-newstyle.webp 250w" width=1600><figcaption>Rendu OSM new style</figcaption></figure><p>Jusqu’alors ma favorite, <a href=https://garmin3.bbbike.org/ rel="noopener noreferrer">la version OSM téléchargeable gratuitement</a> reste quelque peu baroque, avec notamment des routes souvent colorées.</p><h3>Rendu avec ma carte</h3><figure><img alt="Rendu OSM minimaliste" decoding=async height=1093 loading=lazy sizes="(max-width: 1600px) 100vw, 1600px" src=/images_tc/2020/10/newmap-minimalist.webp srcset="/images_tc/2020/10/newmap-minimalist.webp 1600w, /images_tc/2020/10/newmap-minimalist.webp 1024w, /images_tc/2020/10/newmap-minimalist.webp 250w" width=1600><figcaption>Rendu OSM minimaliste</figcaption></figure><p>J’ai donc créé une trace OSM minimaliste, sans POI, sans texte, sans couleur ou presque. Au passage, j’ai fait passer le fichier France de 1,6 Go à 320 Mo, tout en incluant les données altimétriques.</p><p><a href=https://mega.nz/file/19FliI6a#sCYLfnpTCWx99PMWHVEUaq-IARhWUgK21BnswbvXXjQ rel="noopener noreferrer">Vous pouvez télécharger la carte</a> (je ne vous garantis pas de la mettre à jour souvent). Pour l’installer, copiez le fichier dans le dossier Garmin de votre GPS. Si une carte du même nom existe, renommez-là. Il vous reste à dire au GPS d’utiliser de préférence la nouvelle carte (ce qui revient à désactiver les autres). Attention, cette carte n’est pas routable et ne sert que lors du suivi de traces (sur les nouveaux Garmin on peut créer des profils avec des cartes différentes).</p><h3>Rendu avec carte IGN</h3><figure><img alt="Rendu IGN" decoding=async height=1093 loading=lazy sizes="(max-width: 1600px) 100vw, 1600px" src=/images_tc/2020/10/newmap-ign.webp srcset="/images_tc/2020/10/newmap-ign.webp 1600w, /images_tc/2020/10/newmap-ign.webp 1024w, /images_tc/2020/10/newmap-ign.webp 250w" width=1600><figcaption>Rendu IGN</figcaption></figure><p>Sur le Garmin 820, je n’utilisais pas l’IGN parce que l’affichage se traînait tout en manquant de précision. Avec le 530, c’est nettement plus fluide et le contraste de la trace est bien meilleur que sur les cartes Garmin ou OSM. C’est une alternative onéreuse à mon bricolage.</p><h3>Geek only</h3><p>Je résume comment je m’y suis pris pour fabriquer cette carte, tout en faisant hurler le Mac (la même manip marche sous Windows).</p><ol><li><a href=https://www.java.com/fr/download/ rel="noopener noreferrer">Installer Java</a>.</li><li><a href=https://www.oracle.com/java/technologies/javase-jdk15-downloads.html rel="noopener noreferrer">Installer Java SE Development Kit</a>.</li><li>Créer un dossier de travail (dans mon cas <em>~/Documents/GarminMaps/tools/</em>).</li><li><a href=https://download.geofabrik.de/europe/france.html rel="noopener noreferrer">Télécharger dans le dossier <em>tools</em> la dernière source OSM pour France</a> (<a href=http://download.openstreetmap.fr/extracts/europe/ rel="noopener noreferrer">possibilité de télécharger les régions, les départements, d’autres pays…</a>). Ce fichier a pour nom : <em>france-latest.osm.pbf</em>.</li><li><a href=http://www.mkgmap.org.uk/download/splitter.html rel="noopener noreferrer">Télécharger Splitter</a>, un logiciel qui découpera la carte OSM pour que le Mac puisse la digérer.</li><li><a href=http://www.mkgmap.org.uk/download/mkgmap.html rel="noopener noreferrer">Télécharger Mkgmap</a>, un logiciel qui recollera les bouts et créera une carte au format Garmin.</li><li><a href=https://mega.nz/file/RplyUa7L#DZtAnF6QgfrxCWEquqLv0rAyeDAopUPBH-De1C_xscY rel="noopener noreferrer">Télécharger les styles de la nouvelle carte</a> (voilà qui m’a pris la tête et je suis loin d’être devenu un expert du sujet). Reste pas mal de boulot à faire pour créer la carte optimale.</li><li>Décompresser le dossier <em>mystyle</em>. Il contient les fichiers texte qui contrôlent le rendu de la carte.</li><li>Ouvrir le terminal et aller dans <em>tools</em> avec un <em>cd /Users/thierrycrouzet/Documents/GarminMaps/tools/</em>.</li><li>Exécuter Spliter avec <em>java -Xmx3000m -jar splitter/splitter.jar --max-nodes=1100000 france-latest.osm.pbf --output-dir=outputsplit</em>. Ça prend un bon moment.</li><li>Exécuter Mkgmap avec <em>java -Xmx3000m -jar mkgmap/mkgmap.jar --style-file=mystyle --output-dir=output --no-net --product-id=1 --overview-mapname="OSM minimalist" --family-name="OSM minimalist" --series-name="OSM minimalist" --description="OSM minimalist" --area-name="OSM minimalist" --gmapsupp -c outputsplit/template.args</em>. C’est reparti pour au moins aussi longtemps.</li><li>La carte <em>gmapsupp.img</em> se retrouve dans le dossier <em>output</em>.</li><li>J’ai dû picorer des infos <a href=https://wiki.openstreetmap.org/wiki/FR:Mkgmap rel="noopener noreferrer">ici</a> et <a href=https://github.com/ligfietser/mkgmap-style-sheets rel="noopener noreferrer">là</a> ou encore <a href=https://www.cferrero.net/maps/guide_to_mkgmap_style_files.html rel="noopener noreferrer">là</a> avant de m’en sortir, et aussi en tâtonnant beaucoup.</li></ol></section><footer><section><button class=icon_com onclick="showComments('com2232')" title=Commenter aria-label="Afficher les commentaires"></button><button class=icon_share onclick=copyText() title=Partager aria-label="Partager l'article"></button><a class=icon_download href=https://raw.githubusercontent.com/tcrouzet/md/refs/heads/main/2020/10/optimiser-les-cartes-des-gps-garmin.md download title=Télécharger aria-label="Télécharger en Markdown"></a><a class=icon_friends href=/page/lectures/ title="Sites amis" aria-label="Afficher les sites amis"></a></section><div class=comments id=com2232 data-post-url=2020/10/23/optimiser-les-cartes-des-gps-garmin/ data-post-title="Optimiser les cartes des GPS Garmin" data-post-date=2020-10-23T17:32:00+02:00 hidden></div><div><a href=/page/abonnement-par-mail/ ><svg width=24 height=18 viewbox="0 0 24 18" fill=none xmlns=http://www.w3.org/2000/svg><path d="M21.75 1.5H2.25c-.828 0-1.5.672-1.5 1.5v12c0 .828.672 1.5 1.5 1.5h19.5c.828 0 1.5-.672 1.5-1.5V3c0-.828-.672-1.5-1.5-1.5zM15.687 6.975L19.5 10.5M8.313 6.975L4.5 10.5" stroke=#fff stroke-width=1.5 stroke-linecap=round stroke-linejoin=round></path><path d="M22.88 2.014l-9.513 6.56C12.965 8.851 12.488 9 12 9s-.965-.149-1.367-.426L1.12 2.014" stroke=#fff stroke-width=1.5 stroke-linecap=round stroke-linejoin=round></path></svg> Newsletters </a><a href=/page/me-soutenir/ class=link-background> Me soutenir </a></div></footer></article><div id=loadMore next-url=/2020/10/20/mini-aventure-gravel-de-la-nuit-a-la-nuit/ hidden></div></main><script src="/toggle.js?ver=52" defer></script></body></html>
>>>>>>> Stashed changes
