<article id="post-65261" itemscope itemType="https://schema.org/BlogPosting"><meta itemprop="articleSection" content="Born to Bike"/><meta itemprop="name" content="Article"/><meta itemprop="inLanguage" content="fr-FR"/><meta itemprop="author" content="Thierry Crouzet"/><meta itemprop="accountablePerson" content="Thierry Crouzet"/><meta itemprop="datePublished" content="2023-10-29T12:21:19+02:00"/><meta itemprop="dateModified" content="2023-10-31T12:08:22+02:00"/><meta itemprop="url" content="https://tcrouzet.com/2023/10/29/asphalte-gravier-ou-terre/" /><div class="poster maxContainerWidth"><img width="768" height="439" src="https://tcrouzet.com/images_tc/2023/10/stat_i3-768x439.png" class="poster-img poster-img-full" alt="Dall-e" decoding="async" loading="lazy" srcset="https://tcrouzet.com/images_tc/2023/10/stat_i3-768x439.png 768w, https://tcrouzet.com/images_tc/2023/10/stat_i3-1024x585.png 1024w, https://tcrouzet.com/images_tc/2023/10/stat_i3-250x143.png 250w, https://tcrouzet.com/images_tc/2023/10/stat_i3.png 1792w" sizes="(max-width: 768px) 100vw, 768px" /><div class="poster-legend">Dall-e</div><div class="poster-title"><h1 itemprop="headline" id="title65261">Asphalte, gravier ou terre ?</h1><div class="poster-subtitle"><div class="poster-serie"><a href="../../../../2023/10/23/enrichir-automatiquement-vos-itineraires-avec-des-points-dinteret/index.html" class="prev">&lt; </a><a href="../../../../tag/borntobike/index.html">Born to Bike 150</a> ● <span itemprop="datePublished" content="2023-10-29T12:21:00" title="Publié à 12:21"> <a href="../../../../2023/10/index.html">29 octobre</a> <a href="../../../../2023/index.html">2023</a></span><a href="../../../../2018/11/27/lart-du-velo/index.html" class="next"> &gt;</a></div><div class="plus-contenair"><div class="sharemain"><div class="share" id="share65261"><div class="crunchify-social"><a class="icon_com icon" href="../../../../mail/index.html" target="_blank" title="Envoyer un commentaire"></a><a class="icon_mail icon" href="mailto:?subject=%C3%80+lire+%3A+Asphalte%2C+gravier+ou+terre%C2%A0%3F&body=Regarde: https://tcrouzet.com/2023/10/29/asphalte-gravier-ou-terre/" title="Partager par mail"></a><a class="icon_share icon" href="javascript:void(0);" onclick="copyText()" title="Partager"></a></div></div></div><div class="plus">&bull;&bull;&bull;<ul><li><a href="http://www.printfriendly.com/print?url=https://tcrouzet.com/2023/10/29/asphalte-gravier-ou-terre/&amp;partner=sociable">Imprime le billet/PDF</a></li><li><a href="https://tcrouzet-com.translate.goog/2023/10/29/asphalte-gravier-ou-terre/?_x_tr_sl=fr&_x_tr_tl=en&_x_tr_hl=en">Version EN/US</a></li><li><a href="../../../../abonnement-par-mail/index.html">Abonne-toi</a></li><li>Tags : <a href="../../../../tag/borntobike/index.html">Born to Bike</a> | <a href="../../../../tag/gps/index.html">GPS</a> | <a href="../../../../series/index.html">Séries</a></li></li><li><a href="http://creativecommons.org/licenses/by-nc-sa/4.0/deed.fr" class="footertitre">(cc)</a>&#8239;<a href="../../../../informations/index.html">Thierry&#8239;Crouzet</a></li></ul></div></div></div></div></div><div class="post hentry" itemprop="articleBody" id="post-65261"><!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body><p>Je profite d&rsquo;une cr&egrave;ve tenace, qui m&rsquo;emp&ecirc;che d&rsquo;&eacute;crire autant que de p&eacute;daler pour pondre du code, potentiellement utile aux gravellistes, v&eacute;t&eacute;tistes et bikepackers. C&rsquo;est ma fa&ccedil;on de me d&eacute;tendre. En bricolant <a href="../../../../2023/10/23/enrichir-automatiquement-vos-itineraires-avec-des-points-dinteret/index.html">mon syst&egrave;me pour remonter les POI d&rsquo;une trace GPX</a>, j&rsquo;ai d&eacute;couvert une m&eacute;thode pour &eacute;tablir des statistiques pr&eacute;cises sur la nature des terrains parcourus.<span id="more-65261"></span></p>
<div id="image1" class="image"><img width="1466" height="622" src="https://tcrouzet.com/images_tc/2023/10/stat05-komoot.jpg" class="alignnone size-full wp-image-65262 paysage" alt="Komoot" decoding="async" srcset="https://tcrouzet.com/images_tc/2023/10/stat05-komoot.jpg 1466w, https://tcrouzet.com/images_tc/2023/10/stat05-komoot-768x326.jpg 768w, https://tcrouzet.com/images_tc/2023/10/stat05-komoot-1024x434.jpg 1024w, https://tcrouzet.com/images_tc/2023/10/stat05-komoot-250x106.jpg 250w" sizes="(max-width: 1466px) 100vw, 1466px"><div class="legend">Komoot</div></div>
<p><a href="../../../../2022/12/21/comment-evaluer-le-pourcentage-dasphalte-dune-trace/index.html">Jusqu&rsquo;ici je me fiais &agrave; Komoot</a>, sans trop comprendre ce que le service fabriquait (en plus de modifier mes traces). Pas fan de leur manque de transparence comme de leur code propri&eacute;taire, je me suis toujours dit qu&rsquo;il faudrait une solution open source pour arriver &agrave; un r&eacute;sultat du m&ecirc;me type, selon une m&eacute;thode qui aurait l&rsquo;avantage d&rsquo;&ecirc;tre transparente pour que la communaut&eacute; puisse en discuter.</p>
<p>J&rsquo;en arrive presque au bout de ma cr&egrave;ve et je tiens un code Python que <a href="https://colab.research.google.com/drive/1OnIlVr7_iI2cLBQp10XpMCKpOhJtJOcc?usp=sharing">je partage dans Google Colab</a>. Pour l&rsquo;ex&eacute;cuter, on lance <em>Ex&eacute;cution/Tout ex&eacute;cuter</em>, puis descend tout en bas jusqu&rsquo;au bouton <em>Upload</em>. Si vous chargez une trace GPX, elle sera analys&eacute;e, puis les stats s&rsquo;afficheront.</p>
<p>Attention de ne pas charger une trace brute issue d&rsquo;une tr&egrave;s longue sortie. Vos GPS enregistrent des points tous les quelques m&egrave;tres, ce qui g&eacute;n&egrave;re des fichiers tr&egrave;s lourds. Vous pouvez <a href="https://www.visugpx.com/">r&eacute;duire le nombre de points avec VisuGPX</a>, par exemple. La trace provisoire <a href="../../../../i727">i727 2024</a> contient presque 14&nbsp;000 points pour 545&nbsp;km. Le code a eu besoin de pr&egrave;s de 12 minutes pour g&eacute;n&eacute;rer les statistiques (le processus irait beaucoup plus vite sur un serveur d&eacute;di&eacute;).</p>
<div id="image2" class="image"><img width="1360" height="808" src="https://tcrouzet.com/images_tc/2023/10/Untitled-stat06.png" class="alignnone size-full wp-image-65266 portrait" alt="i727" decoding="async" srcset="https://tcrouzet.com/images_tc/2023/10/Untitled-stat06.png 1360w, https://tcrouzet.com/images_tc/2023/10/Untitled-stat06-768x456.png 768w, https://tcrouzet.com/images_tc/2023/10/Untitled-stat06-1024x608.png 1024w, https://tcrouzet.com/images_tc/2023/10/Untitled-stat06-250x149.png 250w" sizes="(max-width: 1360px) 100vw, 1360px"><div class="legend">i727</div></div>
<div id="image3" class="image"><img width="558" height="814" src="https://tcrouzet.com/images_tc/2023/10/stat07.png" class="alignnone size-full wp-image-65267 portrait" alt="i727" decoding="async" srcset="https://tcrouzet.com/images_tc/2023/10/stat07.png 558w, https://tcrouzet.com/images_tc/2023/10/stat07-250x365.png 250w" sizes="(max-width: 558px) 100vw, 558px"><div class="legend">i727</div></div>
<div id="image4" class="image"><img width="736" height="502" src="https://tcrouzet.com/images_tc/2023/10/stat05-komoot3.png" class="alignnone size-full wp-image-65265 portrait" alt="" decoding="async" srcset="https://tcrouzet.com/images_tc/2023/10/stat05-komoot3.png 736w, https://tcrouzet.com/images_tc/2023/10/stat05-komoot3-250x171.png 250w" sizes="(max-width: 736px) 100vw, 736px"></div>
<p>Mes r&eacute;sultats sont proches de ceux de Komoot, logique puisque nous utilisons la m&ecirc;me source OSM, malheureusement fautive. Mais on peut pallier ses erreurs avec un peu de pratique. Lors de l&rsquo;ex&eacute;cution du code, j&rsquo;affiche un bouton <em>Overpass Query</em>. Il permet de t&eacute;l&eacute;charger un fichier texte contenant une requ&ecirc;te &agrave; coller dans la fen&ecirc;tre de gauche d&rsquo;<a href="https://overpass-turbo.eu/">Overpass Turbo</a>. Quand on la lance, les voies rencontr&eacute;es par votre trace s&rsquo;affichent.</p>
<div id="image5" class="image"><img width="1600" height="873" src="https://tcrouzet.com/images_tc/2023/10/stat01-overpass.jpg" class="alignnone size-full wp-image-65264 paysage" alt="Overpass" decoding="async" srcset="https://tcrouzet.com/images_tc/2023/10/stat01-overpass.jpg 1600w, https://tcrouzet.com/images_tc/2023/10/stat01-overpass-768x419.jpg 768w, https://tcrouzet.com/images_tc/2023/10/stat01-overpass-1024x559.jpg 1024w, https://tcrouzet.com/images_tc/2023/10/stat01-overpass-250x136.jpg 250w" sizes="(max-width: 1600px) 100vw, 1600px"><div class="legend">Overpass</div></div>
<p>Quand on clique sur une voie, les donn&eacute;es la d&eacute;crivant apparaissent. Parfois tr&egrave;s compl&egrave;tes, parfois succinctes, parfois fausses. Dans ce dernier cas, on peut cliquer sur le crayon et aller directement modifier la cartographie OSM.</p>
<div id="image6" class="image"><img width="468" height="490" src="https://tcrouzet.com/images_tc/2023/10/stat04-box.jpg" class="alignnone size-full wp-image-65268 portrait" alt="OSM" decoding="async" srcset="https://tcrouzet.com/images_tc/2023/10/stat04-box.jpg 468w, https://tcrouzet.com/images_tc/2023/10/stat04-box-250x262.jpg 250w" sizes="(max-width: 468px) 100vw, 468px"><div class="legend">OSM</div></div>
<p>J&rsquo;ai rencontr&eacute; beaucoup de probl&egrave;mes avec les Pistes de grade 1. Par exemple, une route de vigne de 2&nbsp;km avec seulement dix m&egrave;tres de gravier devient une piste de grade 1, au m&ecirc;me niveau qu&rsquo;une belle DFCI. Comme les informations de surface manquent souvent, impossible de les diff&eacute;rencier. C&rsquo;est une invitation pour am&eacute;liorer OSM. De m&ecirc;me, beaucoup de sentiers (paths dans OSM) sont classifi&eacute;s comme pistes (tracks dans OSM).</p>
<div id="image7" class="image"><img width="1600" height="874" src="https://tcrouzet.com/images_tc/2023/10/stat08.jpg" class="alignnone size-full wp-image-65269 paysage" alt="Geojson" decoding="async" srcset="https://tcrouzet.com/images_tc/2023/10/stat08.jpg 1600w, https://tcrouzet.com/images_tc/2023/10/stat08-768x420.jpg 768w, https://tcrouzet.com/images_tc/2023/10/stat08-1024x559.jpg 1024w, https://tcrouzet.com/images_tc/2023/10/stat08-250x137.jpg 250w" sizes="(max-width: 1600px) 100vw, 1600px"><div class="legend">Geojson</div></div>
<p>Pour v&eacute;rifier la pertinence des statistiques et rep&eacute;rer les erreurs OSM, j&rsquo;affiche &eacute;galement un bouton <em>Geojson Query</em>. On peut t&eacute;l&eacute;charger un fichier json et l&rsquo;ouvrir dans <a href="geojson.io">Geojson.io</a>. On visualise ainsi la trace avec les segments color&eacute;s en fonction de leur nature. J&rsquo;ai beaucoup utilis&eacute; cette possibilit&eacute; lors du d&eacute;bogage. Cette approche permet &eacute;galement d&rsquo;avoir une id&eacute;e d&rsquo;une trace rien qu&rsquo;en regardant son trajet color&eacute;.</p>
<div id="image8" class="image"><img width="2560" height="1400" src="https://tcrouzet.com/images_tc/2023/10/Untitled-stat09-scaled.jpg" class="alignnone size-full wp-image-65270 paysage" alt="i727" decoding="async" srcset="https://tcrouzet.com/images_tc/2023/10/Untitled-stat09-scaled.jpg 2560w, https://tcrouzet.com/images_tc/2023/10/Untitled-stat09-768x420.jpg 768w, https://tcrouzet.com/images_tc/2023/10/Untitled-stat09-1024x560.jpg 1024w, https://tcrouzet.com/images_tc/2023/10/Untitled-stat09-250x137.jpg 250w" sizes="(max-width: 2560px) 100vw, 2560px"><div class="legend">i727</div></div>
<p>Enfin, tout en bas du notebook Codelab, j&rsquo;ai indiqu&eacute; comment j&rsquo;avais rassembl&eacute; les donn&eacute;es, extraites par la fonction find_terrain de la section OSM Analysis (assez simple, donc lisible sans une trop grande ma&icirc;trise de Python). On doit pouvoir am&eacute;liorer ce point. Vous pouvez jouer avec le code.</p>
<div id="image9" class="image"><img width="2036" height="988" src="https://tcrouzet.com/images_tc/2023/10/stat09.png" class="alignnone size-full wp-image-65271 portrait" alt="M&eacute;thode" decoding="async" srcset="https://tcrouzet.com/images_tc/2023/10/stat09.png 2036w, https://tcrouzet.com/images_tc/2023/10/stat09-768x373.png 768w, https://tcrouzet.com/images_tc/2023/10/stat09-1024x497.png 1024w, https://tcrouzet.com/images_tc/2023/10/stat09-250x121.png 250w" sizes="(max-width: 2036px) 100vw, 2036px"><div class="legend">M&eacute;thode</div></div></body></html>
<p></p><div class="sharebas pageGutter"><div class="sharemain"><div class="share" id="share65261"><div class="crunchify-social"><a class="icon_com icon" href="../../../../mail/index.html" target="_blank" title="Envoyer un commentaire"></a><a class="icon_mail icon" href="mailto:?subject=%C3%80+lire+%3A+Asphalte%2C+gravier+ou+terre%C2%A0%3F&body=Regarde: https://tcrouzet.com/2023/10/29/asphalte-gravier-ou-terre/" title="Partager par mail"></a><a class="icon_share icon" href="javascript:void(0);" onclick="copyText()" title="Partager"></a></div></div></div></div></div></article>