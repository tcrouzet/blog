<!DOCTYPE html><html lang=fr xmlns=http://www.w3.org/1999/xhtml xmlns:og=http://opengraphprotocol.org/schema/ xmlns:fb=http://www.facebook.com/2008/fbml><head profile=http://gmpg.org/xfn/11><meta http-equiv=Content-Type content="text/html; charset=utf-8"><meta name=viewport content="width=device-width, initial-scale=1.0"><base href=/ ><link rel="shortcut icon" href=/favicon.ico><link rel=alternate type=application/rss+xml title="Thierry Crouzet" href=/feeds/feed.xml><link rel=preconnect href=https://www.googletagmanager.com><link rel=preconnect href=https://fonts.googleapis.com crossorigin><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Merriweather:ital,wght@0,300;0,400;0,700;0,900;1,300;1,400;1,700;1,900&display=swap" rel=stylesheet><meta name=robots content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"><meta name=google-site-verification content=EmtKKbIk2-Tz3Nyp7hJRPjcMbgf68Vwq6yJYs1hvsqA><meta name=msvalidate.01 content=805E5BFBA891A41968028F5C97A228D3><title>Apprendre à écrire (à ChatGPT) - Thierry Crouzet</title><meta name=description content="En juin 2023, quand j’écrivais la première partie pseudo-houellebecquienne du Code Houellebecq, il était quasi impossible de dresser ChatGPT à imiter le style …"><link href=https://tcrouzet.com/2024/02/09/apprendre-a-ecrire-a-chatgpt/ rel=canonical><meta property=og:locale content=fr_FR><meta property=og:type content=article><meta property=og:title content="Apprendre à écrire (à ChatGPT)"><meta property=og:description content="En juin 2023, quand j’écrivais la première partie pseudo-houellebecquienne du Code Houellebecq, il était quasi impossible de dresser ChatGPT à imiter le style …"><meta content=https://tcrouzet.com/2024/02/09/apprendre-a-ecrire-a-chatgpt/ property=og:url><meta property=og:site_name content="Thierry Crouzet"><meta content=https://www.facebook.com/ThierryCrouzetAuteur/ property=article:publisher><meta content=https://www.facebook.com/ThierryCrouzetAuteur/ property=article:author><meta property=article:published_time content=2024-02-09T10:20:00+01:00><meta property=article:modified_time content=2024-04-30T08:24:30+02:00><meta property=og:image content="https://lab.tcrouzet.com/webp2jpeg.php?url=https://tcrouzet.com/images_tc/2024/02/fine04.webp"><meta property=og:image:width content=1792><meta property=og:image:height content=1024><meta property=og:image:type content=image/jpeg><meta property=fb:app_id content=136907779685410><meta name=author content="Thierry Crouzet"><link rel=stylesheet id=style-css href="/style.css?ver=7" type=text/css media=screen></head><body id=mybody><div id=top><div id=author><div id=toggle class=open></div><span id=nomsmall><a href=/ title="Accueil, Thierry Crouzet" alt="Accueil, Thierry Crouzet">Thierry <b>CROUZET</b></a></span></div><div id=toggle-search></div><div id=access class="access pageGutter"></div><div id=access-search class="access pageGutter"></div></div><div id=top-spacer></div><div id=content class=infinite role=main><article id=article-462 itemscope itemtype=https://schema.org/BlogPosting><meta itemprop=articleSection content=netlitterature><meta itemprop=name content=Article><meta itemprop=inLanguage content=fr-FR><meta itemprop=author content="Thierry Crouzet"><meta itemprop=accountablePerson content="Thierry Crouzet"><meta itemprop=datePublished content=2024-02-09T10:20:00+01:00><meta itemprop=dateModified content=2024-04-30T08:24:30+02:00><meta content=https://tcrouzet.com/2024/02/09/apprendre-a-ecrire-a-chatgpt/ itemprop=url><div class="poster maxContainerWidth"><img width=1792 height=1024 src=/images_tc/2024/02/fine04.webp class="poster-img poster-img-full" alt loading=lazy decoding=async type=image/webp srcset="/images_tc/2024/02/fine04.webp 1600w" sizes="(max-width: 1600px) 100vw, 1600px"><div class=poster-legend>IA tuning</div><div class=poster-title><h1 itemprop=headline id=title462> Apprendre à écrire (à ChatGPT) </h1><div class=poster-subtitle><div class=poster-serie><a href=/2024/02/03/manchette-linterview-post-mortem/ class=prev>&lt; </a><a href=/tag/netlitterature>NetLittérature 183</a> ● <span itemprop=datePublished content=2024-02-09T10:20:00 title="Publié à 10:20"> <a href=/2024/ >09 février 2024</a></span><a href=/2024/02/10/une-nouvelle-en-un-clic/ class=next> &gt;</a></div><div class=plus-contenair><div class=sharemain><div class=share><div class=crunchify-social><a class="icon_com icon" href=/page/mail/ target=_blank title="Envoyer un commentaire"></a><a class="icon_mail icon" href="mailto:?subject=Apprendre+%C3%A0+%C3%A9crire+%28%C3%A0+ChatGPT%29&body=Regarde: 2024/02/09/apprendre-a-ecrire-a-chatgpt/" title="Partager par mail"></a><a class="icon_share icon" href=javascript:void(0); onclick=copyText() title=Partager></a></div></div></div><div class=plus>&bull;&bull;&bull;<ul><li><a href="http://www.printfriendly.com/print?url=2024/02/09/apprendre-a-ecrire-a-chatgpt/&partner=sociable">Imprime le billet/PDF</a></li><li><a href="https://tcrouzet-com.translate.goog2024/02/09/apprendre-a-ecrire-a-chatgpt//?_x_tr_sl=fr&_x_tr_tl=en&_x_tr_hl=en">Version EN/US</a></li><li><a href=/abonnement-par-mail/ >Abonne-toi</a></li><li>Tags : <a href=/tag/netlitterature>Netlittérature </a> | <a href=/tag/ia>Ia </a> | <a href=/tag/iacontent>Iacontent </a> | </li><li><a href=http://creativecommons.org/licenses/by-nc-sa/4.0/deed.fr class=footertitre>(cc)</a>&#8239;<a href=/informations/ >Thierry&#8239;Crouzet</a></li></ul></div></div></div></div></div><div class="post hentry" itemprop=articleBody id=post-462><p>En juin 2023, quand j’écrivais la première partie pseudo-houellebecquienne du <em>Code Houellebecq</em>, il était quasi impossible de dresser ChatGPT à imiter le style d’un auteur. Il en reprenait quelques caractéristiques supposées, s’inspirait de citations, sans être capable d’aller beaucoup plus loin.</p><p>Mon astuce : je lui soumettais des extraits des <em>Particules élémentaires</em>, puis lui demandais de les imiter, mais il y parvenait médiocrement. Résultat : j’ai obtenu un texte avec un vague écho à Houellebecq, ce qui suffisait à mon propos, puisqu’une fan de Houellebecq était la narratrice de cette partie du texte. Il était hors de question pour moi, au-delà de l’histoire racontée, d’intervenir pour faire en sorte que ce texte apparaisse plus houellebecquien. Une IA était à la manœuvre et cela devait se sentir, une IA de 2023, et non pas une IA si puissante qu’elle paraîtrait humaine. J’espérais que le lecteur rirait de sa froide maladresse comme j’ai ri en écrivant.</p><p>Ce témoignage de 2023 doit être dit tout de suite et non dans un futur imprécis qui le transformera en document historique (oui, j’ai décidé de l’autopublier prochainement). Si je devais réécrire le même roman aujourd’hui, il serait beaucoup plus houllebecquien, parce que nous pouvons désormais éduquer ChatGPT à écrire dans un style particulier, <a href=https://platform.openai.com/docs/guides/fine-tuning/preparing-your-dataset>une opération de fine tuning</a> qui nécessite quelques bouts de python. Je vais passer les détails techniques et vous raconter comment je m’en suis tiré.</p><p>La procédure se résume à soumettre à l’IA une centaine de questions et de réponses, ou une centaine de textes lourdingues et les mêmes textes mieux écrits. <a href="https://www.youtube.com/watch?v=NjQP7jRqkBU&ab_channel=SundogEducationwithFrankKane">Dans une vidéo passionnante</a>, j’ai découvert comment entraîner ChatGPT à répondre comme Data, l’IA de <em>Star Treck</em>. L’auteur analyse les dialogues de la série, récupère les questions posées à Data, puis ses réponses. Il dispose ainsi d’un dataset pour l’entraînement.</p><p>Mais pour entraîner une IA à écrire comme nous-mêmes ou un autre auteur, nous ne disposons que de textes que nous jugeons correctement écrits, du moins à notre convenance. Pour disposer de leur version mal écrite, il suffit de demander à ChatGPT de les réécrire dans son style caractéristique, <a href="https://www.youtube.com/watch?v=aZelrCSWQ-k&ab_channel=TheNerdyNovelist">comme le suggère The Nerdy Novelist</a>.</p><p>Voici le premier paragraphe de <em><a href=/../../page/mon-pere-ce-tueur>Mon père ce tueur</a></em>.</p><blockquote><p>Mon père était un tueur. À sa mort, il m’a laissé une lettre de tueur. Je n’ai pas encore le courage de l’ouvrir, de peur qu’elle m’explose à la figure. Il a déposé l’enveloppe dans le coffre où il rangeait ses armes : des poignards, une grenade, un revolver d’ordonnance MAS 1874 ayant servi durant la guerre d’Espagne, une carabine à lunette, et surtout des fusils de chasse, des brownings pour la plupart, tous briqués, les siens comme ceux de son père, grand-père et arrière-grand-père, une généalogie guerrière qui remonte au début du dix-neuvième siècle. Sur les crosses, il a vissé des plaques de bronze avec les noms de ses ancêtres, leur date de naissance, de mort. Sur l’une, il a indiqué : « 1951, mon premier superposé, offert pour mes 15 ans ».</p></blockquote><p>Voici comment l’a réécrit ChatGPT 4 :</p><blockquote><p>Dans mon histoire familiale, mon père jouait le rôle sombre et mystérieux de l’assassin. Lorsqu’il a rendu son dernier souffle, il m’a transmis, tel un héritage funeste, une missive propre aux tueurs. Je suis, à ce jour, envahi d’une appréhension dévorante à l’idée même d’effleurer le papier de cette lettre, redoutant qu’elle ne me jette au visage une explosion de secrets inavouables. Cet objet de malaise, il l’a soigneusement placé dans un coffre, celui-là même où il conservait ses instruments de mort : une collection éclectique allant de poignards acérés à une grenade prête à semer le chaos, en passant par un revolver d’ordonnance MAS 1874, relique d’une guerre d’Espagne révolue, une carabine équipée d’une lunette pour traquer sa proie à distance, et, comme pour parachever cette arsenal, une série de fusils de chasse, principalement des brownings, polis à l’extrême, témoins silencieux de la passion d’une lignée de guerriers, inchangée depuis le début du dix-neuvième siècle. Sur ces armes, témoignage poignant de cette fascination mortelle, il a apposé des plaques de bronze gravées des noms de nos aïeux, ainsi que les dates qui encadrent leur existence terrestre. Sur l’une d’entre elles, il a pris soin de noter : « 1951, mon premier superposé, cadeau de mes 15 ans ».</p></blockquote><p>Comme system prompt, j’ai utilisé :</p><blockquote><p>Et tant que rewriter, tu réécris en français les textes soumis de manière ordinaire, plate, verbeuse, imagée (ce qui résume le style de ChatGPT).</p></blockquote><p>Initialement j’avais utilisé un autre system prompt :</p><blockquote><p>Et tant que rewriter, tu réécris en français les textes soumis de manière ordinaire, plate, verbeuse, imagée, baroque, pour un public très peu éduqué.</p></blockquote><p>Pour un résultat trop flamboyant par rapport à ce que génère ChatGPT naturellement :</p><blockquote><p>Mon paternel, c’était pas vraiment le genre à jouer avec des poupées. Lui, sa chose, c’était plutôt de faire danser le fer et le feu. Quand il a cassé sa pipe, figurez-vous qu’il m’a légué une de ces lettres, mais pas n’importe laquelle, une lettre de tueur. Un truc tellement brûlant que j’ai même pas osé la décacheter, de peur de me retrouver avec la figure en miettes. Il a planqué ce machin dans son coffre à bidules mortels - imaginez un peu, un vrai bric-à-brac de l’apocalypse avec des couteaux affûtés comme des rasoirs, une grenade qui attend son heure, un vieux pistolet qui a fait parler la poudre pendant la castagne en Espagne, une lunette pour tirer les mouches à cent pas, et le clou du spectacle, une ribambelle de fusils de chasse - des engins brillants comme des sous neufs, héritage de ses vieux, son grand-père et même l’arrière-grand-père, une belle lignée de dur à cuire qui remonte jusqu’au temps où Napoléon faisait encore des siennes. Sur le manche, y collait des plaquettes en bronze avec le nom de ses aïeux, leur entrée et sortie de scène. Et sur une, y’a griffonné : « 1951, mon premier fusil superposé, cadeau pour mes 15 berges ».</p></blockquote><p>Effectuer ce travail sur des centaines de paragraphes peut être rébarbatif surtout qu’il faut formater les résultats en jsonl. J’ai donc automatisé.</p><ol><li>J’ai commencé par transformer l’epub officiel de <em><a href=/../../page/mon-pere-ce-tueur>Mon père ce tueur</a></em> en un fichier markdown.</li><li>J’ai sélectionné les paragraphes compris entre 250 et 1 000 signes (379), pour éviter les rares dialogues ou les passages trop longs (180k signes).</li><li>J’ai ensuite demandé à ChatGPT 4 de les réécrire un à un. La procédure a pris des plombes et m’a coûté une dizaine de dollars (suite à plusieurs plantages et bugs dans mon code).</li><li>Pour chaque paragraphe, j’ai créé une entrée dans le fichier jsonl. Elle se compose de trois sections : le prompt système, toujours le même (« Tu es un expert dans la réécriture de textes à la manière de Thierry Crouzet. »), d’un user, typiquement un texte mal écrit et d’un agent assistant, avec le même texte tel que je le voudrais.</li><li>J’ai ainsi obtenu un dataset pour entraîner ChatGPT.</li></ol><div class=image id=image-462-1><img alt=JSONL class="alignnone size-full paysage" decoding=async height=586 loading=lazy sizes="(max-width: 1600px) 100vw, 1600px" src=/images_tc/2024/02/finetune05.webp srcset="/images_tc/2024/02/finetune05.webp 1600w, /images_tc/2024/02/finetune05.webp 1024w, /images_tc/2024/02/finetune05.webp 250w" width=1744><div class=legend>JSONL</div></div><p>La suite est plus immédiate. <a href=https://platform.openai.com/finetune>Sur le playground de ChatGPT</a>, on peut créer une nouvelle version de l’IA à l’aide du dataset précédemment créé.</p><div class=image id=image-462-2><img alt="Fine tuning" class="alignnone size-full paysage" decoding=async height=1306 loading=lazy sizes="(max-width: 1600px) 100vw, 1600px" src=/images_tc/2024/02/fineTs-02.webp srcset="/images_tc/2024/02/fineTs-02.webp 1600w, /images_tc/2024/02/fineTs-02.webp 1024w, /images_tc/2024/02/fineTs-02.webp 250w" width=992><div class=legend>Fine tuning</div></div><div class=image id=image-462-3><img alt="Mon modèle" class="alignnone size-full paysage" decoding=async height=870 loading=lazy sizes="(max-width: 1600px) 100vw, 1600px" src=/images_tc/2024/02/fineTs-01.webp srcset="/images_tc/2024/02/fineTs-01.webp 1600w, /images_tc/2024/02/fineTs-01.webp 1024w, /images_tc/2024/02/fineTs-01.webp 250w" width=1600><div class=legend>Mon modèle</div></div><blockquote><p>Le coucher de soleil hivernal sur l’étang de Thau est un spectacle d’une beauté saisissante, un moment où le ciel embrasé s’offre en tableau vivant au-dessus des eaux calmes. Ce soir-là, le vent souffle avec vigueur, agitant les roseaux et ondulant la surface de l’étang, apportant avec lui le parfum salé de la mer proche. Les derniers rayons du soleil, d’un orange profond, se reflètent dans l’eau, créant un chemin lumineux qui semble conduire au cœur de l’horizon. Au loin, la chaîne des Pyrénées se dessine comme une énigme, ses sommets enneigés capturant les teintes du crépuscule. Ils se tiennent majestueusement, veillant sur le paysage, témoins silencieux de l’éphémère beauté du jour qui s’achève. Le contraste entre la chaleur des couleurs du ciel et la fraîcheur bleutée des montagnes crée une harmonie visuelle qui invite à la contemplation. Le vent, acteur indompté de cette scène, porte avec lui les cris des oiseaux qui regagnent leurs nids pour la nuit, ajoutant une mélodie sauvage au tableau. Les vagues formées par le vent sur l’étang miroitent sous les dernières lueurs du jour, comme si elles dansaient en honneur du soleil disparaissant. Ce coucher de soleil est un moment de transition, une cérémonie naturelle où le jour cède la place à la nuit, où la nature elle-même semble s’arrêter pour admirer la beauté fugace de l’instant. C’est un spectacle qui rappelle la grandeur de la nature, sa capacité à émouvoir et à inspirer, offrant un instant de paix et de réflexion au cœur de l’hiver.</p></blockquote><div class=image id=image-462-4><img alt=Réécriture class="alignnone size-full paysage" decoding=async height=1383 loading=lazy sizes="(max-width: 1600px) 100vw, 1600px" src=/images_tc/2024/02/finetune04-scaled.webp srcset="/images_tc/2024/02/finetune04-scaled.webp 1600w, /images_tc/2024/02/finetune04-scaled.webp 1024w, /images_tc/2024/02/finetune04-scaled.webp 250w" width=2560><div class=legend>Réécriture</div></div><p>Voici la réécriture avec par ChatGPT 3.5 customisé :</p><blockquote><p>Le soleil se couche sur l’étang de Thau. Le vent souffle, les roseaux s’agitent, la surface de l’eau ondule, le sel de la mer se mêle à l’air. Les derniers rayons orangés se reflètent dans l’étang, dessinant une piste lumineuse vers l’horizon. Les Pyrénées se découpent, leurs sommets enneigés prennent la couleur du crépuscule. Ils se dressent, gardiens du paysage, témoins de la beauté éphémère du jour. La chaleur des couleurs du ciel contraste avec la froideur bleutée des montagnes. Le vent emporte les cris des oiseaux qui regagnent leurs nids. Les vagues sur l’étang miroitent. Le coucher de soleil est une cérémonie, un moment de transition, une pause dans la nature. Il rappelle sa grandeur, sa capacité à émouvoir, à inspirer.</p></blockquote><p>Ce n’est toujours pas moi, pas assez de contraste entre les phrases longues et courtes, mais on est déjà très loin du style naturel de ChatGPT. Encore une fois, avec ces expériences, il faut se projeter vers demain, et comprendre que le clonage sera bientôt parfait, et que les modèles égaleront leurs maîtres, voire les dépasseront, capables d’être toujours au meilleur de ce qu’ils peuvent produire, quitte à verser dans la froideur.</p><p>Quelle sera alors notre place en tant qu’auteur ? Devrons-nous être toujours plus radicaux pour nous démarquer ? Ou, au contraire, toujours plus intimistes ? Je n’ai pas de réponse, sinon celles que j’ai données tout au long du <em>Code Houellebecq</em> : je pense notamment que le journal deviendra une forme prépondérante, même s’il sera possible de fabriquer des journaux factices (voilà une idée).</p><p><a href=/2024/01/28/premieres-terreurs-devant-une-ia/ >Avec mon modèle RAG</a>, j’ai posé une question à <a href=/2024/01/13/conversations-1/ >ThierryGPT</a> :</p><blockquote><p>Quel est ton rapport aux couchers de soleil ?</p></blockquote><p>Puis j’ai demandé à mon modèle personnalisé de réécrire la réponse :</p><blockquote><p>Les couchers de soleil m’ont appris à être attentif. Ils m’ont enseigné que rien n’est jamais identique, que chaque seconde est unique, que chaque seconde est belle. Ils m’ont appris la patience et l’humilité. La photographie m’a appris que je pouvais partager des fragments de ma vie, mais aussi que ce partage était souvent vain. J’ai appris à être critique et sélectif. J’ai appris que la répétition pouvait être source de constance, mais aussi de variabilité. J’ai appris que chaque coucher de soleil était une métaphore de la vie, un cycle de fin et de commencement, que chaque journée, même la plus ordinaire, pouvait être extraordinaire. J’ai appris que la beauté était éphémère, que je ne pouvais la retenir, que je ne pouvais la reproduire. J’ai appris que je devais être attentif à l’impermanence. J’ai appris que je pouvais être inspiré par la littérature et la philosophie. J’ai appris que je pouvais chercher le sublime dans le quotidien. J’ai appris que je devais être reconnaissant.</p></blockquote><p>On peut utiliser cette méthode pour imiter des auteurs, créer des personnages avec des phrasés étranges, se réécrire soit même à la recherche de lourdeurs, voire extrapoler des idées que nous aurions pu exprimer et que nous avons jusque là tues. J’aurais pu générer <a href=/2024/02/03/manchette-linterview-post-mortem/ >un interview posthume de Manchette</a> beaucoup plus réaliste dans la forme. Je sais déjà que j’utiliserai cette approche dans mon prochain projet, sans encore trop savoir comment.</p><div class="sharebas pageGutter"><div class=sharemain><div class=share><div class=crunchify-social><a class="icon_com icon" href=/page/mail/ target=_blank title="Envoyer un commentaire"></a><a class="icon_mail icon" href="mailto:?subject=Apprendre+%C3%A0+%C3%A9crire+%28%C3%A0+ChatGPT%29&body=Regarde: 2024/02/09/apprendre-a-ecrire-a-chatgpt/" title="Partager par mail"></a><a class="icon_share icon" href=javascript:void(0); onclick=copyText() title=Partager></a></div></div></div></div></div><div class=load-more-url next-url=/2024/02/03/manchette-linterview-post-mortem/ style="display: none;"></div></article><form id=mailchimp class=pageGutter><div id=thema><label class=checkbox for=mc-blog><input checked=1 type=checkbox value=1 name=mc-blog id=mc-blog>Blog</label><label class=checkbox for=mc-carnet><input checked=1 type=checkbox value=2 name=mc-carnet id=mc-carnet>Carnets</label><label class=checkbox for=mc-ecriture><input checked=1 type=checkbox value=3 name=mc-ecriture id=mc-ecriture>Écriture</label><label class=checkbox for=mc-bike><input checked type=checkbox value=4 name=mc-bike id=mc-bike>Vélo</label><label class=checkbox for=mc-daylog><input checked=1 type=checkbox value=1 name=mc-daylog id=mc-daylog>Genlog</label></div><div aria-hidden=true style="position: absolute; left: -5000px;"><input type=text name=b_4346e7140965015f0594fffcd_f8567ebe86 tabindex=-1 value><input type=text name=b_b7e4cf04c803fc0f26b2fff20_4580f38547 tabindex=-1 value></div><input aria-label="Votre email" type=email name=mc-email id=mc-email onblur="if (this.value==\'\') this.value=\'Ton mail\'" value="Ton mail" onfocus="if (this.value==\'Ton mail\') this.value=\'\'"><input type=hidden value=blog-crouzet name=feed_id><input type=submit name=subscribe value=Abonne-toi alt=Abonne-toi title=Abonne-toi><div id=mc-message></div></form></div><a href=/2024/02/03/manchette-linterview-post-mortem/ ><div next-url=/2024/02/03/manchette-linterview-post-mortem/ id=loadMore></div></a><script type=text/javascript src="/toggle.js?ver=7" id=toggle-js defer></script><div id=copyMessage></div></body></html>